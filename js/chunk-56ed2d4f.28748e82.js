(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56ed2d4f"],{"9b06":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("h2",{staticStyle:{"text-align":"center"}},[e._v("发布新课程")]),i("el-steps",{staticStyle:{"margin-bottom":"40px"},attrs:{active:2,"process-status":"wait","align-center":""}},[i("el-step",{attrs:{title:"填写课程基本信息"}}),i("el-step",{attrs:{title:"创建课程大纲"}}),i("el-step",{attrs:{title:"提交审核"}})],1),i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openAddChapter()}}},[e._v("添加章节")]),i("ul",{staticClass:"chanpterList"},e._l(e.chapterVideoList,(function(t){return i("li",{key:t.id},[i("p",[e._v(" "+e._s(t.title)+" "),i("span",{staticClass:"acts"},[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.openAddVideo(t.id)}}},[e._v("添加小节")]),i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.openUpdateChapter(t.id)}}},[e._v("编辑")]),i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.delChapterInfo(t.id)}}},[e._v("删除")])],1)]),i("ul",{staticClass:"chanpterList videoList"},e._l(t.children,(function(t){return i("li",{key:t.id},[i("p",[e._v(" "+e._s(t.title)+" "),i("span",{staticClass:"acts"},[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.openUpdateVideo(t.id)}}},[e._v("编辑")]),i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.delVideoInfo(t.id)}}},[e._v("删除")])],1)])])})),0)])})),0),i("div",[i("el-button",{on:{click:e.previous}},[e._v("上一步")]),i("el-button",{attrs:{disabled:e.saveBtnDisabled,type:"primary"},on:{click:e.next}},[e._v("下一步")])],1),i("el-dialog",{attrs:{visible:e.dialogChapterFormVisible,title:"添加章节"},on:{"update:visible":function(t){e.dialogChapterFormVisible=t}}},[i("el-form",{attrs:{model:e.eduChapter,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"章节标题"}},[i("el-input",{model:{value:e.eduChapter.title,callback:function(t){e.$set(e.eduChapter,"title",t)},expression:"eduChapter.title"}})],1),i("el-form-item",{attrs:{label:"章节排序"}},[i("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:e.eduChapter.sort,callback:function(t){e.$set(e.eduChapter,"sort",t)},expression:"eduChapter.sort"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogChapterFormVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.saveOrUpdate}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{visible:e.dialogVideoFormVisible,title:"添加课时"},on:{"update:visible":function(t){e.dialogVideoFormVisible=t}}},[i("el-form",{attrs:{model:e.eduVideo,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"课时标题"}},[i("el-input",{model:{value:e.eduVideo.title,callback:function(t){e.$set(e.eduVideo,"title",t)},expression:"eduVideo.title"}})],1),i("el-form-item",{attrs:{label:"课时排序"}},[i("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:e.eduVideo.sort,callback:function(t){e.$set(e.eduVideo,"sort",t)},expression:"eduVideo.sort"}})],1),i("el-form-item",{attrs:{label:"是否免费"}},[i("el-radio-group",{model:{value:e.eduVideo.isFree,callback:function(t){e.$set(e.eduVideo,"isFree",t)},expression:"eduVideo.isFree"}},[i("el-radio",{attrs:{label:1}},[e._v("免费")]),i("el-radio",{attrs:{label:0}},[e._v("默认")])],1)],1),i("el-form-item",{attrs:{label:"视频链接"}},[i("a",{attrs:{href:"#"},on:{click:function(t){return e.openurl("/learn/player?id="+e.eduVideo.videoSourceId)}}},[i("div",[e._v(e._s(e.eduVideo.videoOriginalName))])])]),i("el-form-item",{attrs:{label:"上传视频"}},[i("el-upload",{staticClass:"upload-demo",attrs:{"on-success":e.handleVodUploadSuccess,"on-remove":e.handleVodRemove,"before-remove":e.beforeVodRemove,"on-exceed":e.handleUploadExceed,"file-list":e.fileList,action:"/apisc/eduvod/video/uploadVideo",headers:e.headers,limit:1}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传视频")]),i("el-tooltip",{attrs:{placement:"right-end"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 最大支持1G， "),i("br"),e._v("支持3GP、ASF、AVI、DAT、DV、FLV、F4V、 "),i("br"),e._v("GIF、M2T、M4V、MJ2、MJPEG、MKV、MOV、MP4、 "),i("br"),e._v("MPE、MPG、MPEG、MTS、OGG、QT、RM、RMVB、 "),i("br"),e._v("SWF、TS、VOB、WMV、WEBM 等视频格式上传 ")]),i("i",{staticClass:"el-icon-question"})])],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVideoFormVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{disabled:e.saveVideoBtnDisabled,type:"primary"},on:{click:e.saveOrUpdateVideo}},[e._v("确 定")])],1)],1)],1)},a=[],d=(i("b0c0"),i("5c96")),s=i.n(d),n=(i("0fae"),i("b775")),r={getChapterVideoById:function(e){return Object(n["b"])({url:"/eduservice/educhapter/getChapterVideoById?courseId=".concat(e),method:"get"})},addChapter:function(e){return Object(n["b"])({url:"/eduservice/educhapter/addChapter",method:"post",data:e})},delChapter:function(e){return Object(n["b"])({url:"/eduservice/educhapter/delChapter?id=".concat(e),method:"delete"})},getChapterById:function(e){return Object(n["b"])({url:"/eduservice/educhapter/getChapterById?id=".concat(e),method:"get"})},updateChapter:function(e){return Object(n["b"])({url:"/eduservice/educhapter/updateChapter",method:"post",data:e})}},u={addVideo:function(e){return Object(n["b"])({url:"/eduservice/eduvideo/addVideo",method:"post",data:e})},delVideo:function(e){return Object(n["b"])({url:"/eduservice/eduvideo/delVideo?id=".concat(e),method:"delete"})},getVideoById:function(e){return Object(n["b"])({url:"/eduservice/eduvideo/getVideoById?id=".concat(e),method:"get"})},updateVideo:function(e){return Object(n["b"])({url:"/eduservice/eduvideo/updateVideo",method:"post",data:e})}},l=i("8bbf"),c=i.n(l),p=i("9fb0");c.a.use(s.a);var h={data:function(){return{courseId:"",saveBtnDisabled:!1,chapterVideoList:[],dialogChapterFormVisible:!1,eduChapter:{},saveVideoBtnDisabled:!1,dialogVideoFormVisible:!1,eduVideo:{},fileList:[],headers:{Authorization:c.a.ls.get(p["a"])}}},created:function(){this.$route.query.id&&(this.courseId=this.$route.query.id,this.getChapterVideoList())},methods:{goPage:function(e){event.preventDefault(),this.$router.push({path:e})},openurl:function(e){event.preventDefault(),window.open(e,"_blank")},handleVodRemove:function(){var e=this;u.deleteAliyunvod(this.video.videoSourceId).then((function(t){e.$message({type:"success",message:"删除视频成功!"}),e.fileList=[],e.video.videoSourceId="",e.video.videoOriginalName=""}))},beforeVodRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},getChapterVideoList:function(){var e=this;r.getChapterVideoById(this.courseId).then((function(t){e.chapterVideoList=t.data.chapterVideoList}))},openAddChapter:function(){this.eduChapter={},this.dialogChapterFormVisible=!0},saveOrUpdate:function(){this.eduChapter.id?this.updateChapterInfo():this.saveChapter()},saveChapter:function(){var e=this;this.eduChapter.courseId=this.courseId,r.addChapter(this.eduChapter).then((function(t){e.$message({type:"success",message:"添加成功!"}),e.dialogChapterFormVisible=!1,e.getChapterVideoList()}))},updateChapterInfo:function(){var e=this;r.updateChapter(this.eduChapter).then((function(t){e.$message({type:"success",message:"修改成功!"}),e.dialogChapterFormVisible=!1,e.getChapterVideoList()}))},delChapterInfo:function(e){var t=this;this.$confirm("此操作将永久删除该章节, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.delChapter(e).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.getChapterVideoList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},openUpdateChapter:function(e){var t=this;r.getChapterById(e).then((function(e){t.eduChapter=e.data.eduChapter,t.dialogChapterFormVisible=!0}))},openAddVideo:function(e){this.eduVideo={},this.eduVideo.chapterId=e,this.dialogVideoFormVisible=!0},openUpdateVideo:function(e){var t=this;u.getVideoById(e).then((function(e){t.eduVideo=e.data.eduVideo,t.dialogVideoFormVisible=!0}))},saveOrUpdateVideo:function(){this.eduVideo.id?this.updateVideoInfo():this.saveVideo()},saveVideo:function(){var e=this;this.eduVideo.courseId=this.courseId,u.addVideo(this.eduVideo).then((function(t){e.$message({type:"success",message:"添加成功!"}),e.dialogVideoFormVisible=!1,e.getChapterVideoList()}))},updateVideoInfo:function(){var e=this;u.updateVideo(this.eduVideo).then((function(t){e.$message({type:"success",message:"修改成功!"}),e.dialogVideoFormVisible=!1,e.getChapterVideoList()}))},delVideoInfo:function(e){var t=this;this.$confirm("此操作将永久删除该章节, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){u.delVideo(e).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.getChapterVideoList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleVodUploadSuccess:function(e,t,i){this.eduVideo.videoSourceId=e.data.videoId},handleUploadExceed:function(e,t){this.$message.warning("想要重新上传视频，请先删除已上传的视频")},previous:function(){this.$router.push({path:"/course/add",query:{id:this.courseId}})},next:function(){this.$router.push({path:"/course/publish",query:{id:this.courseId}})}}},f=h,v=(i("fa94"),i("2877")),V=Object(v["a"])(f,o,a,!1,null,"786fae4c",null);t["default"]=V.exports},ea2a:function(e,t,i){},fa94:function(e,t,i){"use strict";i("ea2a")}}]);